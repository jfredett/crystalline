#!/usr/bin/env ruby

require 'gli'
begin # XXX: Remove this begin/rescue before distributing your app
  require 'crystalline'
rescue LoadError
  STDERR.puts "In development, you need to use `bundle exec bin/crystalline` to run your app"
  STDERR.puts "At install-time, RubyGems will make sure lib, etc. are in the load path"
  exit 64
end

include GLI::App

program_desc ''

version Crystalline::VERSION

desc 'Generate a README for the current app'
command :readme do |c|

  c.action do |global, options, args|
    require 'crystalline/generators/readme'
    gem_name = File.basename(File.expand_path('.'))
    user = ENV['USER']
    if File.exists?('README.md')
      puts Crystalline::Generators::Readme.generate!(user, gem_name)
    else
      File.write('README.md', 'w+') do |f| 
        f.puts Crystalline::Generators::Readme.generate!(user, gem_name)
      end
    end

  end

end


exit run(ARGV)
